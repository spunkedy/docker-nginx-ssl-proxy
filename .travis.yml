sudo: required
services:
- docker
env:
  global:
  - secure: Ml6Ue9FrZ2WIpjC74Y8tM2ro4q7UqdFiDgePNS89TVVPSZj1TbMYBObkb13cDPA3zcPy103kgCxfJ8dM41RwaHyw61cfYIK4wyzIQ0WJJuctjOB1iNzY+tFwotCdKIs7/6CUMZctDDrevAY0xbcjbJyQGIfQOmUjz8EsbHi5egsadFCS0TZeU6xYHz37STMMg7GCz9ppQ0cgWKSjbkcbFu1M39M/pHu6r0eysfJd+7slY2FAd/PU5BBz6hlwKxOhdGC/18hd2/Cawf6Wv7ElN3RD0VJJZs4HHx3pyAwTVtj/Cmr4EkQnMW1oIgLbudRt7p7XIYelB/Wk+jAbP1sYT4QPQqyXASpbDnt7slw7H2Z+7kUb9e0Nz4MyWEdLlwysxS3D4Z7ivHXFn8gFuoLUQ8kQffIiTladtjrO2oBYvelQcJsjquoaRKasfLj7N39i3pb2xbXEmcHOoYf4FRrOW+XExjGyKwAXdiGKlE2zll9n9PNlYYzYfOVJz1uR52QtO7uPlZPtfDKfmSi2qQmLeazN8+2+eIUlXB38TtOSiRvp5X+lrBHfLV5petUMcDx+fWawV+XwieSlAdshaNrRi04hm7MAG1ZYj7Ft9voAuDeM2/BLh7sppWXjNguoHEJ3ecx1CFlPhImuYuUYb/BudyoPRcC+yFSh9EXJHA/FZZg=
  - secure: BDsByaYguy0L2uvjp+bjnSZ06uc8PhuFuNjYLpPkTojQAcm8YRZvEcnGHtmvT9AUbgNqbhNI0OGFhkBlS1uZSmVEyTzNXAKY5vidk+u9E7rm8K6lcIcdDA8YAbsyGWkqvfWOyIQE3MNG2QVxUQWz75bC9g742dXpUq/M35565INB3ltjAkMtG67H2Styn6cq8rLJovdULPGrRoqJnPt3j5QiGxz0KFCg8pZ4DxYhJMuu+SFopLvhOPrXqHoGhWqz7Ilcw+F4zgF0H4jSppoWRZd8IjbYNr5wrkQxcDGkccL/AiJ6ZMDp9rdXzydnTTVccx8RXMB978XL2fkJFfyERA1XseeTCTJc77e+c6X2m7HVV8esOfTfw/1xtTzcgpuoSIRsMZqx7rPoISqroCzYtAekEs2g095xW7rnF4RqvWonRn9C8ua3Vr2BM5smke7f+7/QtskcGwS69mReA2fWda/kzAnLd30QnBLWfH68cxkIihCf0X3qKRgLpeOSY6ZZNiIy9dx164ETxnwLdj9GKuxq6HHR6Y4/w3HxJCZrvI0JXWcFMFCPsw+AD3mQTSdMd2SCTPteNUllEyWseyOFdR25kEATeClepvXYZjF5TJApBUNo4F+PClArvrxN58rI6Y4yskYc3dLvieYZ1anpllW160xsxukRJ1MqLeqWECQ=
  - secure: SGmgnBoJMyR3AU5Yh4KmQsKCkcOe7RfAJMW5lMJb0fQooc5i717iADbxy9L1dRa+PZsJuVxacZrSoBqKUEFUdlVZrSV17fjySAK0/mkf7CBMR6SpFoogXK4Cc7PmAsnL8ef0COi5Quv0JVMfvsbSuYxeW2TI9RMvl0DnyxbQqKPI+R42YSo2Kogjqetq/1mkd5nqqrmnJt5gy0DcdTEdFGNh1XqmnLPXp5p42cy6OuO2rxf8QmCh0CYrTD+UkscQACAJtEVfcB2bB0oJV0/mRx9OKVvtik7NPkGK000de3DROye+jWTheVSZ8EiSnNL1mT8jwRJaj94uSgGZuOdLciJDusl63JF+cODhCRye2MVDr+E/5iJgDtyAvMYNr0kDbXplwTBoFJi4blG5L4jsh+pFxAUM70pZWvgl7d33uylmvStLniMisgtAxcExr+6f5I6GrcRvSPwLWEkPJ51PxDrgIwz1q64zR0bcHbH1H/7XqNcswU6AKQ7x7FJbuuMSUXPc8nicM1lQMT0JtKJjfC0vfMCw/2ar9/Sk2PNXGMk2XSd+nrwM7cHyH8Bp/0I94m93WBnNsbT0xskTvYik524wDM23AcF4og2KRX2GF8JL06JMLmy9qBuv/6H1UEbvepNmsecrs9w3a7uXV2eUjSqL2ZhgDqi8os+0IasG4+4=

after_success:
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
  - export REPO=spunkedy/docker-nginx-ssl-proxy
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -f Dockerfile -t $REPO:$COMMIT .
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
  - docker push $REPO
